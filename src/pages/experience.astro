---
import { getCollection } from 'astro:content';
import BaseHead from '../components/BaseHead.astro';
import Footer from '../components/Footer.astro';
import Header from '../components/Header.astro';

const experiences = (await getCollection('experience')).sort(
	(a, b) => b.data.startDate.valueOf() - a.data.startDate.valueOf()
);

function formatDate(date: Date) {
	return date.toLocaleDateString('en-US', { year: 'numeric', month: 'short' });
}
---

<!doctype html>
<html lang="en">
	<head>
		<BaseHead title="Experience - Prabin T P" description="Professional experience and work history" />
	</head>
	<body class="bg-gray-50">
		<Header />
		<main class="max-w-4xl mx-auto px-4 py-12">
			<div class="mb-12">
				<h1 class="text-4xl font-bold text-gray-900 mb-4">Experience</h1>
				<p class="text-lg text-gray-600">13+ years of professional software engineering experience</p>
			</div>

			<div class="space-y-8">
				{experiences.map((exp) => (
					<article class="bg-white rounded-lg shadow-md p-8 hover:shadow-lg transition-shadow">
						<div class="flex flex-col md:flex-row md:items-start md:justify-between mb-4">
							<div>
								<h2 class="text-2xl font-bold text-gray-900">
									<a href={`/experience/${exp.id}`} class="hover:text-blue-600 transition-colors">
										{exp.data.position}
									</a>
								</h2>
								<h3 class="text-xl text-blue-600 font-semibold">{exp.data.company}</h3>
								{exp.data.location && (
									<p class="text-gray-600">{exp.data.location}</p>
								)}
							</div>
							<div class="text-gray-600 mt-2 md:mt-0 md:text-right">
								<p class="font-medium">
									{formatDate(exp.data.startDate)} - {exp.data.current ? 'Present' : formatDate(exp.data.endDate!)}
								</p>
								{exp.data.current && (
									<span class="inline-block px-3 py-1 text-xs font-semibold text-green-600 bg-green-100 rounded-full mt-2">
										Current Position
									</span>
								)}
							</div>
						</div>

						<a href={`/experience/${exp.id}`} class="text-blue-600 hover:text-blue-800 text-sm font-medium">
							View details â†’
						</a>
					</article>
				))}
			</div>
		</main>
		<Footer />
	</body>
</html>
